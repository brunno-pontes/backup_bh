{% extends "base.html" %}
{% block content %}
<div class="card" style="max-width: 560px; margin: 2rem auto;">
  <div class="card-body">
    <h5 class="card-title">Complete seu perfil</h5>
    <p class="text-muted">Precisamos do seu aniversário e sexo para liberar o acesso completo ao sistema.</p>

    {% set has_user = user is defined and user %}
    {% set aniversario_val = (user.aniversario.strftime('%Y-%m-%d') if has_user and user.aniversario else '') %}
    {% set sexo_val = (user.sexo if has_user and user.sexo else '') %}

    <form method="post" novalidate>
      {# Se mais tarde habilitar CSRF e injetar generate_csrf no contexto:
         {% if csrf_token is defined %}
           <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
         {% endif %}
      #}

      <div class="mb-3">
        <label class="form-label d-block">Sexo</label>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" id="sexoM" name="sexo" value="M" {{ 'checked' if sexo_val == 'M' else '' }}>
          <label class="form-check-label" for="sexoM">Masculino (M)</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" id="sexoF" name="sexo" value="F" {{ 'checked' if sexo_val == 'F' else '' }}>
          <label class="form-check-label" for="sexoF">Feminino (F)</label>
        </div>
      </div>

      <div class="mb-3">
        <label for="aniversario" class="form-label">Aniversário</label>
        <input type="date" class="form-control" id="aniversario" name="aniversario"
               value="{{ aniversario_val }}" required>
        <div class="form-text">Formato: AAAA-MM-DD</div>
      </div>

      <button type="submit" class="btn btn-primary">Salvar e continuar</button>
      <p class="text-muted mt-3" style="font-size: 0.9rem;">
        Suas informações são usadas apenas para regras de negócio (ex.: elegibilidade de Dayoff) e não são compartilhadas.
      </p>
    </form>
  </div>
</div>
{% endblock %}
